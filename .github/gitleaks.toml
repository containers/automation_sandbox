# Options Ref:
# https://github.com/gitleaks/gitleaks#configuration

[extend]
# useDefault will extend the base configuration with the default gitleaks config:
# https://github.com/zricethezav/gitleaks/blob/master/config/gitleaks.toml
useDefault = true

[[rules]]
# These ENCRYPTED[blahblahblah] entries are only valid from two two
# file contexts.  They're also hard-coded to each repo. so are useless
# on any forks.  This check is here simply to raise red-flags on any
# movement of these values w/in these files.
id = "cirrus-ci-config-secret"
description = "Cirrus-CI Configuration Secret ID"
path = '''(cirrus.yml)|(.+\.star)'''
regex = '''.*ENCRYPTED[\[]([a-fA-f0-9])[\]].*'''
secretGroup = 1  # in regex
